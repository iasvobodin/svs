precision mediump float;
attribute vec3 aVertexPosition;
attribute vec2 aTextureCoord;
uniform mat4 uMVMatrix;
uniform mat4 uPMatrix;
uniform mat4 activeTexMatrix;
uniform float uProgress;
varying vec3 vVertexPosition;
varying vec2 vTextureCoord;
#define M_PI 3.1415926535897932384626433832795
 vec3 deformationCurve(vec3 position, vec2 uv, float offset) {
   position.x = position.x - (sin(uv.y * M_PI) * offset/4.);
//    position.y = position.y + (sin(uv.x * M_PI) * offset);
   return position;
 }

void main() {
vec3 vertexPosition = aVertexPosition;
vec3 newPosition = deformationCurve(vertexPosition, aTextureCoord, uProgress);
vertexPosition.x+=2.*(1. - uProgress);
// newPosition.xy *= 1.35;
// newPosition.z += 0.000001;
gl_Position = uPMatrix * uMVMatrix * vec4(vertexPosition, 1.0);
vTextureCoord = (activeTexMatrix * vec4(aTextureCoord, 0.0, 1.0)).xy;
vVertexPosition = vertexPosition;
}